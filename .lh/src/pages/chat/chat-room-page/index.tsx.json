{
    "sourceFile": "src/pages/chat/chat-room-page/index.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1740156387806,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1740156393396,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import ChatLayout from \"../layouts\";\n import Header from \"./components/header\";\n import Footer from \"./components/footer\";\n import Sidebar from \"./components/sidebar\";\n-import Icon from \"./.common/components/icons\";\n+import Icon from \"./../../../common/components/icons\";\n import useChatRoom from \"./hooks/useChatRoom\";\n import ProfileSection from \"./components/profile\";\n import SearchSection from \"./components/search-section\";\n import useNavigateToChat from \"./hooks/useNavigateToChat\";\n"
                }
            ],
            "date": 1740156387806,
            "name": "Commit-0",
            "content": "import { useEffect, useRef, useState } from \"react\";\nimport ChatLayout from \"../layouts\";\nimport Header from \"./components/header\";\nimport Footer from \"./components/footer\";\nimport Sidebar from \"./components/sidebar\";\nimport Icon from \"./.common/components/icons\";\nimport useChatRoom from \"./hooks/useChatRoom\";\nimport ProfileSection from \"./components/profile\";\nimport SearchSection from \"./components/search-section\";\nimport useNavigateToChat from \"./hooks/useNavigateToChat\";\nimport { Container, Body, Background, FooterContainer, ScrollButton } from \"./styles\";\nimport MessagesList from \"./components/messages-list\";\nimport useIsDesktop from \"../hooks/useWindowSize\";\nimport { useChatContext } from \"../context/chat\";\nimport { useLocation } from \"react-router-dom\";\n\nexport default function ChatRoomPage() {\n  const {\n    activeInbox,\n    handleMenuOpen,\n    handleShowIcon,\n    isProfileOpen,\n    isSearchOpen,\n    setIsProfileOpen,\n    setIsSearchOpen,\n    setShouldScrollToBottom,\n  } = useChatRoom();\n\n  useNavigateToChat(activeInbox);\n  const messagesListRef = useRef<HTMLDivElement>(null);  \n  const chatCtx = useChatContext();\n  const location = useLocation();\n\n  const [isScrolled, setIsScrolled] = useState(false);\n  const [searchTerm, setSearchTerm] = useState<string>(\"\"); \n  const isDesktop = useIsDesktop();\n  const [changeRoute, setChangeRoute] = useState('')\n  \n  useEffect(() => {\n    setChangeRoute(location.pathname)\n  }, [chatCtx.chatSelected, location]);\n\n  const handleScrollToBottom = () => {\n    const currentRef = messagesListRef.current;\n\n    if (!currentRef) return;\n    \n    setTimeout(() => {\n      currentRef.scrollTop = currentRef.scrollHeight;\n    }, 100); \n  };\n\n  const handleScroll = () => {\n    const currentRef = messagesListRef.current;\n    if (!currentRef) return;\n\n    const { scrollHeight, clientHeight, scrollTop } = currentRef;\n    const targetScroll = scrollHeight - clientHeight;\n\n    \n    if (scrollTop >= targetScroll - 10) {  \n      setIsScrolled(true);\n    } else {\n      setIsScrolled(false);\n    }\n  };\n  \n  useEffect(() => {\n    const currentRef = messagesListRef.current;\n\n    if (currentRef) {\n      currentRef.addEventListener('scroll', handleScroll);\n    }\n\n    return () => {\n      if (currentRef) {\n        currentRef.removeEventListener('scroll', handleScroll);\n      }\n    };\n  }, []);\n\n  \n  useEffect(() => {\n    setIsSearchOpen(false)\n    if (messagesListRef.current) {\n      handleScrollToBottom();\n    }\n  }, [activeInbox]);\n\n  return (\n    <ChatLayout>\n      <Container\n        className={isDesktop ? '' :  changeRoute !== '/' ? 'isMobile' : '' }>\n        <Body>\n          <Background />\n          <Header\n            inbox={activeInbox}\n            title={activeInbox?.phone ?? \"\"}\n            image={/*activeInbox?.image ?? \"\"*/ ''}\n            subTitle={/*activeInbox?.isOnline ? \"Online\" : \"\"*/ ''}\n            onSearchClick={() => handleMenuOpen(\"search\")}\n            onProfileClick={() => handleMenuOpen(\"profile\")}\n          />\n\n          <MessagesList\n            ref={messagesListRef}\n            onMessagesLoaded={() => setShouldScrollToBottom(true)}\n            searchTerm={searchTerm}  \n            filterInChat={true}\n          />\n\n          <FooterContainer>\n            {\n              !isScrolled && \n              <ScrollButton onClick={handleScrollToBottom}>\n                <Icon id=\"downArrow\" />\n              </ScrollButton>\n            }\n\n            <Footer onSendMessage={() => setShouldScrollToBottom(true)} />\n          </FooterContainer>\n        </Body>\n\n        {\n          isSearchOpen && \n          <Sidebar title=\"Search\" isOpen={isSearchOpen} onClose={() => setIsSearchOpen(false)}>\n            <SearchSection />\n          </Sidebar>\n        }\n      \n        <Sidebar\n          title=\"Contact Info\"\n          isOpen={isProfileOpen}\n          onClose={() => setIsProfileOpen(false)}\n        >\n          <ProfileSection name={activeInbox?.phone ?? \"\"} image={/*activeInbox?.image ?? \"\"*/ ''} />\n        </Sidebar>\n      </Container>\n    </ChatLayout>\n  );\n}\n"
        }
    ]
}